package mekabuild_test

import (
	"bytes"
	"testing"

	"github.com/meka-dev/mekatek-go/mekabuild"
)

func TestBuildBlockRequestSignBytes(t *testing.T) {
	have := mekabuild.BuildBlockRequestSignBytes(
		"testchain-1",
		500,
		"validator-42",
		1234,
		5678,
		[]byte("txsHash"),
	)

	want := []byte{
		0x62, 0x75, 0x69, 0x6c, 0x64, 0x2d, 0x62, 0x6c,
		0x6f, 0x63, 0x6b, 0x2d, 0x72, 0x65, 0x71, 0x75,
		0x65, 0x73, 0x74, 0x0b, 0x00, 0x00, 0x00, 0x00,
		0x00, 0x00, 0x00, 0x74, 0x65, 0x73, 0x74, 0x63,
		0x68, 0x61, 0x69, 0x6e, 0x2d, 0x31, 0xf4, 0x01,
		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0c, 0x00,
		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x76, 0x61,
		0x6c, 0x69, 0x64, 0x61, 0x74, 0x6f, 0x72, 0x2d,
		0x34, 0x32, 0xd2, 0x04, 0x00, 0x00, 0x00, 0x00,
		0x00, 0x00, 0x2e, 0x16, 0x00, 0x00, 0x00, 0x00,
		0x00, 0x00, 0x07, 0x00, 0x00, 0x00, 0x00, 0x00,
		0x00, 0x00, 0x74, 0x78, 0x73, 0x48, 0x61, 0x73,
		0x68,
	}

	if !bytes.Equal(have, want) {
		t.Fatalf("\nhave: %#v\nwant: %#v", have, want)
	}
}
